\documentclass[../main.tex]{subfiles}

\begin{document}

\begin{figure*}[t]
    \[\begin{array}{lrclr}
        \textrm{Ctx} & \Gamma  & ::= & \epsilon                    & \textrm{empty context} \\
                     &         &     & \Gamma, \typeJ{\alpha}{K}   & \textrm{type variable} \\
                     &         &     & \Gamma, \termJ{x}{A}        & \textrm{term variable} \\
    \end{array}\]
    
    \begin{prooftree}
        \AxiomC{}
        \UnaryInfC{\(\ctxni{\Gamma, \typeJ{\alpha}{K}}{\typeJ{\alpha}{K}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{}
        \UnaryInfC{\(\ctxni{\Gamma, \termJ{x}{A}}{\termJ{x}{A}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\ctxni{\Gamma}{\typeJ{\alpha}{K}}\)}
        \AxiomC{\(\alpha \not= \beta\)}
        \BinaryInfC{\(\ctxni{\Gamma, \typeJ{\beta}{J}}{\typeJ{\alpha}{K}}\)}
    \end{prooftree}
    
     \begin{prooftree}
        \AxiomC{\(\ctxni{\Gamma}{\typeJ{\alpha}{K}}\)}
        \UnaryInfC{\(\ctxni{\Gamma, \termJ{y}{B}}{\typeJ{\alpha}{B}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\ctxni{\Gamma}{\termJ{x}{A}}\)}
        \UnaryInfC{\(\ctxni{\Gamma, \typeJ{\beta}{J}}{\termJ{x}{A}}\)}
    \end{prooftree}
    
     \begin{prooftree}
        \AxiomC{\(\ctxni{\Gamma}{\termJ{x}{A}}\)}
        \AxiomC{\(x \not= y\)}
        \BinaryInfC{\(\ctxni{\Gamma, \termJ{y}{B}}{\termJ{x}{A}}\)}
    \end{prooftree}
    
    \caption{Contexts}
    \label{fig:Plutus_core_contexts}
\end{figure*}





\begin{figure*}[t]
    \judgmentdef{\(\hypJ{\Gamma}{\istypeJ{A}{K}}\)}{In context $\Gamma$, type $A$ has kind $K$}
    
    \begin{prooftree}
        \AxiomC{\(\ctxni{\Gamma}{\typeJ{\alpha}{K}}\)}
        \RightLabel{tyvar}
        \UnaryInfC{\(\hypJ{\Gamma}{\istypeJ{\alpha}{K}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma}{\istypeJ{B}{\typeK{}}}\)}
        \AxiomC{\(\hypJ{\Gamma}{\istypeJ{A}{\typeK{}}}\)}
        \RightLabel{tyfun}
        \BinaryInfC{\(\hypJ{\Gamma}{\istypeJ{\funT{B}{A}}{\typeK{}}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma, \typeJ{\alpha}{K}}{\istypeJ{A}{\typeK{}}}\)}
        \RightLabel{tyforall}
        \UnaryInfC{\(\hypJ{\Gamma}{\istypeJ{\allT{\alpha}{K}{A}}{\typeK{}}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma, \typeJ{\alpha}{J}}{\istypeJ{A}{K}}\)}
        \RightLabel{tylam}
        \UnaryInfC{\(\hypJ{\Gamma}{\istypeJ{\lamT{\alpha}{J}{A}}{\funK{J}{K}}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma}{\istypeJ{S}{\funK{J}{K}}}\)}
        \AxiomC{\(\hypJ{\Gamma}{\istypeJ{T}{J}}\)}
        \RightLabel{tyapp}
        \BinaryInfC{\(\hypJ{\Gamma}{\istypeJ{\appT{A}{B}}{K}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma, \typeJ{\alpha}{K}}{\istypeJ{A}{K}}\)}
        \RightLabel{tyfix}
        \UnaryInfC{\(\hypJ{\Gamma}{\istypeJ{\fixT{\alpha}{K}{A}}{K}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{$bt$ is $K$}
        \RightLabel{tybuiltin}
        \UnaryInfC{\(\hypJ{\Gamma}{\istypeJ{\conT{bt}}{K}}\)}
    \end{prooftree}
    
    \caption{Kind Synthesis}
    \label{fig:Plutus_core_kind_synthesis}
\end{figure*}





\begin{figure*}[t]
    \judgmentdef{\(\hypJ{\Gamma}{\istermJ{M}{A}}\)}{In context $\Gamma$, term $M$ has type $A$}
    
    \begin{prooftree}
        \AxiomC{\(\ctxni{\Gamma}{\termJ{x}{A}}\)}
        \RightLabel{var}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{x}{A}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma, \termJ{x}{A}}{\istermJ{M}{A}}\)}
        \RightLabel{fix}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{\fix{x}{A}{M}}{A}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma, \typeJ{\alpha}{K}}{\istermJ{M}{A}}\)}
        \RightLabel{abs}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{\abs{\alpha}{K}{M}}{\allT{\alpha}{K}{A}}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \alwaysNoLine
        \AxiomC{\(\hypJ{\Gamma}{\istermJ{L}{\allT{\alpha}{K}{B}}}\)}
        \UnaryInfC{\(\hypJ{\Gamma}{\istypeJ{A}{K}}\)}
        \alwaysSingleLine
        \RightLabel{inst}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{\inst{L}{A}}{\subst{A}{\alpha}{B}}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma, \termJ{y}{B}}{\istermJ{M}{A}}\)}
        \RightLabel{lam}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{\lam{y}{B}{M}}{\funT{B}{A}}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \alwaysNoLine
        \AxiomC{\(\hypJ{\Gamma}{\istermJ{L}{\funT{A}{B}}}\)}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{M}{A'}}\)}
        \UnaryInfC{\(A = A'\)}
        \alwaysSingleLine
        \RightLabel{app}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{\app{L}{M}}{B}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \alwaysNoLine
        \AxiomC{\(M \not= \fix{x}{B}{N}\)}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{M}{\subst{\fixT{\alpha}{K}{A}}{\alpha}{A}}}\)}
        \alwaysSingleLine
        \RightLabel{equi}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{M}{\fixT{\alpha}{K}{A}}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{$bi$ is $A$}
        \RightLabel{builtin}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{\con{bi}}{A}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\hypJ{\Gamma}{\istypeJ{A}{\typeK{}}}\)}
        \RightLabel{error}
        \UnaryInfC{\(\hypJ{\Gamma}{\istermJ{\error{A}}{A}}\)}
    \end{prooftree}
    
    \caption{Type Synthesis}
    \label{fig:Plutus_core_type_synthesis}
\end{figure*}






\begin{figure*}
    \begin{prooftree}
        \AxiomC{\(\coeqJ{A}{A'}\)}
        \UnaryInfC{\(A = A'\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{}
        \UnaryInfC{\(\coeqJ{\alpha}{\alpha}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\coeqJ{A}{A'}\)}
        \AxiomC{\(\coeqJ{B}{B'}\)}
        \BinaryInfC{\(\coeqJ{\funT{A}{B}}{\funT{A'}{B'}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(K = K'\)}
        \AxiomC{\(\coeqJ{A}{\subst{\alpha}{\alpha'}{A'}}\)}
        \BinaryInfC{\(\coeqJ{\allT{\alpha}{K}{A}}{\allT{\alpha'}{K'}{A'}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(K = K'\)}
        \AxiomC{\(\coeqJ{A}{\subst{\alpha}{\alpha'}{A'}}\)}
        \BinaryInfC{\(\coeqJ{\lamT{\alpha}{K}{A}}{\lamT{\alpha'}{K'}{A'}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\coeqJ{A}{A'}\)}
        \AxiomC{\(\coeqJ{B}{B'}\)}
        \BinaryInfC{\(\coeqJ{\appT{A}{B}}{\appT{A'}{B'}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\coeqJ{\subst{\fixT{\alpha}{K}{A}}{\alpha}{A}}{A'}\)}
        \UnaryInfC{\(\coeqJ{\fixT{\alpha}{K}{A}}{A'}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{\(\coeqJ{A}{\subst{\fixT{\alpha'}{K'}{A'}}{\alpha'}{A'}}\)}
        \UnaryInfC{\(\coeqJ{A}{\fixT{\alpha'}{K'}{A'}}\)}
    \end{prooftree}
    
    \begin{prooftree}
        \AxiomC{}
        \UnaryInfC{\(\coeqJ{\conT{bt}}{\conT{bt}}\)}
    \end{prooftree}
    
    \caption{Coinductive Equality}
    \label{fig:Plutus_core_coinductive_equality}
\end{figure*}


\begin{figure*}
    $Q$ is a set of pairs of types, membership in which is strict on-the-nose syntactic equality.
    
    \begin{align*}
        &\coeqF{Q}{A}{A'} ~|~ (A,A') \in Q ~ := ~ \mathbf{true}\\
        &\coeqF{Q}{\alpha}{\alpha'} ~ := ~ \alpha = \alpha'\\
        &\coeqF{Q}{\funT{A}{B}}{\funT{A'}{B'}} ~ :=\\
          &\qquad \coeqF{(Q \cup \{(\funT{A}{B},\funT{A'}{B'})\})}{A}{A'} ~ \wedge ~\\
          &\qquad \coeqF{(Q \cup \{(\funT{A}{B},\funT{A'}{B'})\})}{B}{B'}\\
        &\coeqF{Q}{\allT{\alpha}{K}{A}}{\allT{\alpha'}{K'}{A'}} ~ :=\\
          &\qquad K = K' ~ \wedge ~ \coeqF{(Q \cup \{(\allT{\alpha}{K}{A},\allT{\alpha'}{K'}{A'})\})}{A}{\subst{\alpha}{\alpha'}{A'}}\\
        &\coeqF{Q}{\lamT{\alpha}{K}{A}}{\lamT{\alpha'}{K'}{A'}} ~ :=\\
          &\qquad K = K' ~ \wedge ~ \coeqF{(Q \cup \{(\lamT{\alpha}{K}{A},\lamT{\alpha'}{K'}{A'})\})}{A}{\subst{\alpha}{\alpha'}{A'}}\\
        &\coeqF{Q}{\appT{A}{B}}{\appT{A'}{B'}} ~ :=\\
          &\qquad \coeqF{(Q \cup \{(\appT{A}{B},\appT{A'}{B'})\})}{A}{A'} ~ \wedge ~\\
          &\qquad \coeqF{(Q \cup \{(\appT{A}{B},\appT{A'}{B'})\})}{B}{B'}\\
        &\coeqF{Q}{\fixT{\alpha}{K}{A}}{A'} ~ :=\\
          &\quad\coeqF{(Q \cup \{(\fixT{\alpha}{K}{A},A')\})}{(\subst{\fixT{\alpha}{K}{A}}{\alpha}{A})}{A'}\\
        &\coeqF{Q}{A}{\fixT{\alpha'}{K'}{A'}} ~ :=\\
          &\quad\coeqF{(Q \cup \{(A,\fixT{\alpha'}{K'}{A'}))\}}{A}{(\subst{\fixT{\alpha'}{K'}{A'}}{\alpha'}{A'})}\\
        &\coeqF{Q}{\conT{bt}}{\conT{bt'}} ~ := ~ bt = bt'\\
        &\coeqF{Q}{A}{A'} ~ := ~ \mathbf{false}\\
    \end{align*}
    
    \caption{Algorithmic Coinductive Equality}
    \label{fig:Plutus_core_computable_coinductive_equality}
\end{figure*}






\end{document}